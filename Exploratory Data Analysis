#The goal of this script was to explore correlations contained in the Federal Reserve Economic Data (FRED).
#This was good practice for creating correlation matrices before creating graphs and running T-tests.

#Checking for necessary packages
library("dplyr")
library("corrplot")


# Loading all data into the script 
Unemployment = read.csv("C:/Users/lilni/OneDrive - Mount St. Mary's University/Desktop/FRED Data Science/Unemployment.csv")
CC_Delinq = read.csv("C:/Users/lilni/OneDrive - Mount St. Mary's University/Desktop/FRED Data Science/CC_Delinquency.csv")
Effective_Rate = read.csv("C:/Users/lilni/OneDrive - Mount St. Mary's University/Desktop/FRED Data Science/Effective_Rate.csv")

#Check column names within the data for the join to work
head(Unemployment)
head(CC_Delinq)
head(Effective_Rate)

#Kept seeing an error with the inner_join so renaming the columns to make sure they match
Unemployment <- Unemployment %>% rename(Date = DATE, Unemployment = UNRATE)
CC_Delinq <- CC_Delinq %>% rename (Date = DATE, CC_Rate = DRCCLACBS)
Effective_Rate <- Effective_Rate %>% rename (Date = DATE, Effect_Rate = DFF)

# Join the data together based on their dates
Merged_Data <- Unemployment %>%
  inner_join(CC_Delinq, by = "Date") %>%
  inner_join(Effective_Rate, by = "Date")

# Putting all the joined data into one table
Raw_Variables <- Merged_Data %>%
  select(Unemployment, CC_Rate, Effect_Rate)

# Mutating the data to be numeric for the sake of the correlation matrix
# All raw data is a percentage so mutating to numeric should maintain correlational relationships
Variables <- Raw_Variables %>%
  mutate(
    Unemployment = as.numeric(Unemployment),
    CC_Rate = as.numeric(CC_Rate),
    Effect_Rate = as.numeric(Effect_Rate)
  )

# Create and print correlation matrix
Correlation_Matrix <- cor(Variables)
print(Correlation_Matrix)

# Seeing that the correlation between Credit Card Delinquency and Effective Federal Fund Rate is 0.77,
# it is somewhat expected because of the relationship between the two factors. As the Federal Funds Rate
# increases, so does the Credit Card Interest Rate which makes it more difficult for low income families
# to make their minimum monthly payment, therefore increasing the Credit Card Delinquency Rate




